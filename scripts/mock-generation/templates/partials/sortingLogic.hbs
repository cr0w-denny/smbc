// Handle different data types for sorting
if (typeof aVal === 'string' && typeof bVal === 'string') {
  const comparison = aVal.localeCompare(bVal);
  return sortOrder === 'desc' ? -comparison : comparison;
} else if (typeof aVal === 'number' && typeof bVal === 'number') {
  return sortOrder === 'desc' ? bVal - aVal : aVal - bVal;
} else if (aVal instanceof Date && bVal instanceof Date) {
  return sortOrder === 'desc' ? bVal.getTime() - aVal.getTime() : aVal.getTime() - bVal.getTime();
} else {
  // Fallback to string comparison
  const comparison = String(aVal).localeCompare(String(bVal));
  return sortOrder === 'desc' ? -comparison : comparison;
}